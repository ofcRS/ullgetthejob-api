# API Configuration
PORT=3000
NODE_ENV=development

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/ullgetthejob

# Session Management
# CRITICAL: Change this to a random 32+ character string in production
# Generate with: openssl rand -hex 32
SESSION_SECRET=your-secret-session-key-change-in-production

# Core Service Communication
# URL of the Phoenix Core service
CORE_URL=http://localhost:4000

# ORCHESTRATOR_SECRET is used for:
# 1. Authenticating requests TO Core service
# 2. HMAC request signing (prevents request tampering)
# 3. Verifying requests FROM Core service
# CRITICAL: Must match Core service's ORCHESTRATOR_SECRET
ORCHESTRATOR_SECRET=your-orchestrator-secret-key

# AI Service (OpenRouter)
OPENROUTER_API_KEY=your-openrouter-api-key

# CORS
# Comma-separated list of allowed origins
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# File Upload
MAX_FILE_SIZE=10485760
UPLOAD_DIR=./uploads

# Optional: Telegram contact
TELEGRAM_HANDLE=@yourusername

# SECURITY NOTES:
# ================
#
# 1. OAuth Token Storage:
#    - API does NOT store HH_ACCESS_TOKEN or any OAuth tokens
#    - All OAuth tokens are managed exclusively by Core service
#    - API only stores session IDs and forwards them to Core
#
# 2. Session Management:
#    - Sessions use signed cookies with SESSION_SECRET
#    - Cookies are HTTP-only, Secure (in prod), SameSite=Lax
#    - Session IDs are used to look up OAuth tokens in Core
#
# 3. Request Signing:
#    - All requests to Core include HMAC signature
#    - Signature uses ORCHESTRATOR_SECRET + timestamp
#    - Prevents request tampering and replay attacks
#
# 4. Circuit Breaker:
#    - Protects Core service from cascading failures
#    - Opens after 5 consecutive failures
#    - Stays open for 60 seconds before testing recovery
#
# 5. Response Caching:
#    - AI responses cached for 1-2 hours
#    - Reduces API costs by 50%+ for repeated requests
#    - In-memory LRU cache with 500-1000 entry limit
#
# 6. File Validation:
#    - Magic byte verification prevents file type spoofing
#    - ZIP bomb detection for DOCX files
#    - File name validation (no path traversal)
#    - Supported types: PDF, DOCX, DOC, TXT
#
# 7. WebSocket Authentication:
#    - Auth check during handshake (before connection)
#    - Unauthenticated connections rejected with code 1008
#    - Session tracked per connection
